(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{1218:function(t,e,n){"use strict";n.r(e);n(19),n(162);var r=n(0),i=n(1),s=n.n(i),c=n(46),u=n(52),a=n(10),o=n(8),b=n(40),d=function(){return o.a.get("account/"+Object(b.c)()+"/portfolios/items_count")},h=n(145),l=new h.a("all-portfolio-items-counter"),f=function(t){var e=this;Object(r.a)(this,void 0);var n="count_"+t.userId,s=l.getItem(n)||{},c=s.currentItemsCounter,u=s.isUnread,o=Object(i.useState)({currentItemsCounter:c||0,isUnread:u||!1}),b=o[0],h=o[1];Object(i.useEffect)(function(){Object(r.a)(this,e),l.setItem(n,{currentItemsCounter:b.currentItemsCounter,isUnread:b.isUnread})}.bind(this),[b.currentItemsCounter,b.isUnread,n]);var f=Object(i.useRef)(null),m=Object(i.useCallback)(function(){Object(r.a)(this,e),h({currentItemsCounter:b.currentItemsCounter,isUnread:!1})}.bind(this),[b.currentItemsCounter]),j=Object(i.useCallback)(function(){var t=this;Object(r.a)(this,e),f.current&&!b.isUnread&&d().then(function(e){Object(r.a)(this,t);var n=e.data.count;return h({currentItemsCounter:n,isUnread:b.isUnread||b.currentItemsCounter<n}),n}.bind(this)).catch(function(e){Object(r.a)(this,t),a.a.error(e)}.bind(this))}.bind(this),[b.currentItemsCounter,b.isUnread]);return{startPoling:Object(i.useCallback)(function(){Object(r.a)(this,e),f.current=setInterval(j,12e4),j()}.bind(this),[j]),stopPoling:function(){Object(r.a)(this,e),clearInterval(f.current),f.current=null}.bind(this),resetItemsCounter:m,isUnread:b.isUnread,intervalRef:f}}.bind(void 0),m="__73e33-1Hh6Y",j=function(t){return t.match(u.a["account.portfolio"])},I=function(t){var e=this;Object(r.a)(this,void 0);var n=t.userId,u=Object(c.i)().pathname,a=f({userId:n}),o=a.isUnread,b=a.startPoling,d=a.stopPoling,h=a.resetItemsCounter,l=a.intervalRef;return Object(i.useEffect)(function(){var t=this;if(Object(r.a)(this,e),!j(u))return l.current||j(u)?void 0:(b(),function(){Object(r.a)(this,t),d()}.bind(this));h()}.bind(this),[n,u]),o&&!j(u)?s.a.createElement("span",{className:m}):null}.bind(void 0);e.default=I}}]);